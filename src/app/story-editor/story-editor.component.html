<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="#">Story Editor</a>
        </div>
      
        <button class="btn btn-success navbar-btn" (click)="clear()">New Story</button>
        <button style="float:right;" class="btn btn-default navbar-btn" (click)="export()">Export</button>
        <button *ngIf="!selecting" style="" class="btn btn-default navbar-btn" (click)="activateSelectionMode()">
            <i class="fa fa-share-alt" aria-hidden="true"></i> Make Connections</button>
        <button *ngIf="selecting" style="" class="btn btn-danger navbar-btn" (click)="deactivateSelection()">
            <i class="fa fa-times" aria-hidden="true"></i> Cancel
        </button>
        <button style="float:right;" class="btn btn-info navbar-btn">Help</button>
    </div>
</nav>
<div class="container-fluid">
    <div class="row">
        <div class="story-title">
            <input [(ngModel)]="storyTitle" type="text" placeholder="Story title">
        </div>
        <div class="canvas col-sm-9 push-sm-3" (onDrop)="drop($event)" pDroppable="dd">
            <!-- / boolean to see if we should show the 'drag and drop story...' sign //only show if canvas is blank /i.e canvas array  is empty -->
            <div *ngIf="elementsOnCanvas.length === 0" class="traced-sign grey-out">
                <p class="middle-text grey-out">
                    Drag and drop Story Elements here
                </p>
            </div>
            <!-- temp - remove  -->
            <!--  <md-card  style="width: 200px;height:70px" (dblclick)="op2.show($event)" >
                  
                   <img md-card-image style="float:left;width:50px;height: 50px" class="canvas-icons" [src]="testImg">
                    
                    
                        <md-card-title style="margin-left:20%;font-size:15px" >{{testTitle}}</md-card-title>
                        <md-card-subtitle style="margin-left:20%;font-size:10px;">{{testDesc}} <a style="font-size: 14px;float: right;" [href]="testUrl"><i  class="fa fa-external-link" aria-hidden="true"></i></a></md-card-subtitle>
                       
                   
                </md-card>
                <input size="25" pInputText type="text" [(ngModel)]="testInput" (keyup)="valuechange(testInput,$event)"/> -->
            <!-- remove after testing  -->
            <!-- <div [dragula]='"first-bag"'> -->
            <!-- old <div style="margin:2%;width:100px" *ngFor="let ele of elementsOnCanvas; let i = index;" [(ngGridItem)]="ele.config" (onDrag)="onDrag(i, $event)" [id]="ele.id"> -->
            <div class="card" style="margin:2%;width:24%;position: absolute;" (click)="chosenElement(ele.id)" *ngFor="let ele of elementsOnCanvas; let i = index;" [id]="ele.id">
                <!-- stiuff from url will go here -->
                <div class="handle"> </div>
                <!-- old <md-card style="width: 200px;height:70px" (dblclick)="op2.show($event)"> -->
                <md-card *ngIf="ele.isEditable" (dblclick)="ele.isEditable=false;enlarge(ele.id)">
                    <!--  <img style="width:20px;height: 20px" [src]="ele.src" md-card-sm-image> -->
                    <img md-card-image style="float:left;width:50px;height: 50px" class="canvas-icons" [src]="ele.urlSummary.img">
                    <!-- <img class="canvas-icons" [src]="ele.src" md-card-avatar>
                        <md-card-title>Shiba Inu</md-card-title>
                        <md-card-subtitle>Dog Breed</md-card-subtitle>-->
                    <md-card-title style="margin-left:20%;font-size:15px">{{ele.urlSummary.title}}</md-card-title>
                    <md-card-subtitle style="margin-left:20%;font-size:10px;">{{ele.urlSummary.desc}} 
                        <a title="go to site"  style="font-size: 14px;float: right;margin-left: 7px;margin-right: -15px;" [href]="ele.urlSummary.url">
                            <i  class="fa fa-external-link" aria-hidden="true"></i>
                        </a>
                        <a title="view url preview" *ngIf="ele.inputArray['0'].value !== '' " (click)="getUrlSummary(ele)" style="font-size: 14px;float: right;">
                            <i class="fa fa-eye" aria-hidden="true"></i>
                        </a>
                    </md-card-subtitle>
                </md-card>
                <fieldset *ngIf="!ele.isEditable" (dblclick)="ele.isEditable=true;shrink(ele.id)">
                    <legend><img class="canvas-icons" [src]="ele.src"></legend>
                    <input size="25" pInputText type="text" [placeholder]="input.name" *ngFor="let input of ele.inputArray;let in=index" [(ngModel)]="input.value" [id]="input.id" />
                    <!-- SHOW START/END SPEACIAL INPUT BOX IF CLICKED  -->
                    <!-- todo: when to date boxes get added one goes to second line -->
                    <span style="margin-right: 3%;" *ngIf="ele.startDateAdded && ele.type==='event'">
                    <p-calendar  [(ngModel)]="ele.startDate" [showTime]="true" [showIcon]="true" ></p-calendar> 
                   
                    </span>
                    <span style="margin-right: 3%;" *ngIf="ele.endDateAdded && ele.type==='event'">
                    <p-calendar  [(ngModel)]="ele.endDate" [showTime]="true" [showIcon]="true"></p-calendar> 
                   
                    </span>
                    <select [(ngModel)]="selectedOption" (ngModelChange)="processEleAttribute(selectedOption.id,ele.type,ele.inputArray,ele.attributeArray,ele)">
                        <option selected disabled> Add an Attribute </option>
                        <option *ngFor="let item of ele.attributeArray" [ngValue]="item">{{item.name}}</option>
                    </select>
                    <!--  <p-dropdown [options]="ele.attributeArray" [(ngModel)]="selectedOption"></p-dropdown> -->
                    <!-- test to see if each box's input  is unique -->
                    <!-- <div>words: {{ele.inputArray | json}}</div> -->
                    <!--  old delete button <button class="grey-out" style="float:right;background-color: transparent;" (click)="deleteElementFromCanvas(ele.id)"><img style="height:10px;width:10px" src="../../assets/images/trash.png"></button> -->
                    <img class="delete-icon grey-out" (click)="deleteElementFromCanvas(ele.id)" src="../../assets/images/trash.png">
                    <!-- <button  class="btn btn-default navbar-btn" (click)="getUrlSummary(ele)" style="font-size: 14px;float: right;">
                            <i class="fa fa-eye" aria-hidden="true"></i>
                        </button> -->
                </fieldset>
            </div>
            <!--   </div> -->
            <!-- elements will go here -->
        </div>
        <div class="col-sm-3">
            <div class="sidebar-nav-fixed pull-right affix">
                <div class="well">
                    <!-- removed from well pDraggable="dd"-->
                    <!-- <h3></h3> -->
                    <p-accordion pDraggable="dd" [multiple]="true">
                        <p-accordionTab header="Story Elements" [selected]="true">
                            <div class="story-elements">
                                <img title="Thing (e.g. document, webpage, chart)" pDraggable="thing" (onDragStart)="dragStart($event,'thing')" (onDragEnd)="dragEnd($event)" draggable="true" class="spacing" src="../../assets/images/document64.png">
                                <img title="Event (e.g. inaguration, meeting, conference)" align=" " pDraggable="event" (onDragStart)="dragStart($event,'event')" (onDragEnd)="dragEnd($event)" draggable="true" class="spacing" src="../../assets/images/event64.png">
                                <img title="Actor (e.g. organisation, person)" pDraggable="actor" (onDragStart)="dragStart($event,'actor')" (onDragEnd)="dragEnd($event)" draggable="true" style="width: 64px; height: 54px;" class="spacing" src="../../assets/images/actor-icon2.png">
                            </div>
                        </p-accordionTab>
                        <br>
                        <p-accordionTab header="Labels" [selected]="true">
                            <div class="story-elements">
                                <img draggable="true" class="spacing" src="../../assets/images/book5464.png">
                                <img draggable="true" class="spacing" src="../../assets/images/speech64.png">
                                <img draggable="true" class="spacing" src="../../assets/images/webPage64.png">
                                <!-- <img style="width: 64px; height: 54px;" class="spacing"  src="../../assets/images/actor-icon2.png"> -->
                            </div>
                        </p-accordionTab>
                        <br>
                        <p-accordionTab header="Actor Types" [selected]="true">
                            <div class="story-elements">
                                <img draggable="true" class="spacing" src="../../assets/images/organisation64.png">
                                <img draggable="true" class="spacing" src="../../assets/images/person64.png">
                                <img draggable="true" class="spacing" src="../../assets/images/email64.png">
                                <img draggable="true" class="spacing" src="../../assets/images/sofwareAgent.png">
                                <!-- <img style="width: 64px; height: 54px;" class="spacing"  src="../../assets/images/actor-icon2.png"> -->
                            </div>
                        </p-accordionTab>
                    </p-accordion>
                </div>
            </div>
        </div>
    </div>
    <p-confirmDialog header="Do you wish to leave this page ?" icon="fa fa-question-circle" width="425"></p-confirmDialog>
